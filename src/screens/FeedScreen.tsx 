import React from 'react';
import { ScrollView, StyleSheet } from 'react-native';
import { Card, Text, Icon } from 'react-native-paper';

export default function FeedScreen({ navigation }: any) {
  const [facts, setFacts] = React.useState<any[]>([]);
  const [loading, setLoading] = React.useState(true);

  async function loadFacts() {
    try {
      const response = await fetch('https://catfact.ninja/facts?limit=10');
      const data = await response.json();
      setFacts(data.data);
    } catch (error) {
      console.log('Erro ao buscar fatos:', error);
    } finally {
      setLoading(false);
    }
  }

  React.useEffect(() => {
    loadFacts();
  }, []);

  return (
    <ScrollView style={styles.container}>
      {loading ? (
        <Card>
          <Card.Content>
            <Text>Carregando fatos sobre gatos...</Text>
          </Card.Content>
        </Card>
      ) : (
        facts.map((item, index) => (
          <Card
            key={index}
            mode="elevated"
            style={{ marginBottom: 12 }}
            onPress={() =>
              navigation.navigate('Detalhes', { from: 'Cat Facts', fact: item.fact })
            }
          >
            <Card.Title
              title={`Fato #${index + 1}`}
              left={(props) => <Icon source="cat" size={24} {...props} />}
            />
            <Card.Content>
              <Text>{item.fact}</Text>
            </Card.Content>
          </Card>
        ))
      )}
    </ScrollView>
  );
}

const styles = StyleSheet.create({
  container: { padding: 16, backgroundColor: '#FAFAFA' },
});
